function lookup_ccg_by_postcode(e){gtag("event","search",{search_term:"postcode"});var t="https://api.postcodes.io/postcodes/"+encodeURIComponent(e.value.trim()),o=new XMLHttpRequest;o.open("GET",t,!0),o.onload=function(){if(200===o.status){var e=JSON.parse(o.responseText);output_div.innerHTML="";var t=document.createElement("p");if(t.innerHTML="<strong>CCG Name:</strong> "+e.result.ccg,output_div.insertAdjacentElement("beforeend",t),e.result.codes.ccg){if(ccg_nhs_codes[e.result.codes.ccg]){var n=document.createElement("p");n.innerHTML="<strong>NHS code:</strong> "+ccg_nhs_codes[e.result.codes.ccg],output_div.insertAdjacentElement("beforeend",n)}var c=document.createElement("p");c.innerHTML="<strong>ONS/GSS code:</strong> "+e.result.codes.ccg,output_div.insertAdjacentElement("beforeend",c)}}else{output_div.innerHTML="";var s=document.createElement("p");s.innerHTML="Postcode not found",s.classList.add("error"),output_div.insertAdjacentElement("beforeend",s)}},o.onerror=function(){output_div.innerHTML="";var e=document.createElement("p");e.innerHTML="Connection error from API",e.classList.add("error"),output_div.insertAdjacentElement("beforeend",e)},o.send()}var postcode_field=document.getElementById("postcode"),lookup_button=document.getElementById("lookup"),output_div=document.getElementById("output"),ccg_nhs_codes={},codes_request_url="ccg-data.min.json",codes_request=new XMLHttpRequest;codes_request.open("GET",codes_request_url,!0),codes_request.onload=function(){200===codes_request.status&&(ccg_nhs_codes=JSON.parse(codes_request.responseText))},codes_request.onerror=function(){},codes_request.send(),postcode_field.addEventListener("keyup",function(e){13===e.keyCode&&(e.preventDefault(),lookup_ccg_by_postcode(postcode_field),postcode_field.blur())}),lookup_button.addEventListener("click",function(e){e.preventDefault(),lookup_ccg_by_postcode(postcode_field)});
